import{Q as e,a}from"./QTd.14f40a51.js";import{c as l}from"./index.229e2d0a.js";import{j as o,r as i,ca as s,c as t,w as d,ar as r,aA as n,a1 as u,b2 as f,d as c,J as b,cJ as m,a4 as v,cb as g,c4 as p,aa as w,a2 as y}from"./index.1921beeb.js";import{Q as h}from"./QPage.a28e4bed.js";import{u as k,Q as L,d as _,t as x,b as j,c as C}from"./module-master.be57f47e.js";import{Q as V,b as A}from"./QItemLabel.ed81b066.js";import{a as Q}from"./QSelect.00c3c8b7.js";import{Q as B}from"./ComQDialogBig.ace7afb0.js";import{u as I,t as q,f as O}from"./module-transaksi.a96af80c.js";import{u as R}from"./myglobalstate.9e951e82.js";import{_ as U}from"./ComPopupImgPdfBarcode.65e8a2e9.js";import"./QList.0ff0e2c9.js";import"./QImg.65c43243.js";import"./ComBarcodeGenerator.1bbbf28b.js";const S={class:"row q-mb-md q-col-gutter-xs"},F={class:"col-12"},W={class:"row q-mb-sm"},z={class:"col-12 text-right"},N={class:"row"},P={class:"col-12"},$={class:"row justify-evenly",style:{width:"200px"}},D={class:"col"},G={class:"col"},T={class:"col"},J={class:"row q-mt-md justify-between"},K={class:"q-gutter-xs"},M={class:"q-gutter-xs"},E=o({__name:"TransaksiBarangINGudangFormPage",setup(o){R().title="Form Request Barang Masuk Gudang";const E=I(),H=[e=>e&&e.length>0||"Required!"];i("");const X=s(),Y=i([{name:"remove",label:"",field:"",align:"left",sortable:!1},{name:"barid",label:"Barang",field:"",align:"left",sortable:!0},{name:"file",label:"File",field:"",align:"left",sortable:!0},{name:"offid",label:"Office",field:"offid",align:"left",sortable:!0},{name:"wareid",label:"Warehouse",field:"wareid",align:"left",sortable:!0}]),Z=i(l(q)),ee=i(l(Z.value)),ae=i([]),le=i(),oe={...l(O),header:l(q),detail:[],location:l(_),office:l(x),warehouse:l(j),blok:l(C)},ie=k(),se=i(l(ie.officeList)),te=i(l(ie.warehouseList)),de=i(l(ie.blokList)),re=i(l(ie.locationList)),ne=i(l(E.dbBarangDetail).flat(1)),ue=async(e,a)=>{if(se.value&&se.value.length>0)return""===e?void a((()=>{se.value=ie.officeList})):void a((()=>{const a=e.toLowerCase();se.value=ie.officeList.filter((e=>e.offdesc&&e.offdesc.toLowerCase().indexOf(a)>-1))}));await ie.getOfficeAll(),a((()=>{se.value=ie.officeList}))},fe=async(e,a)=>{if(te.value&&te.value.length>0)return""===e?oe.location.offid&&oe.location.offid.length>0?void a((()=>{var e;const a=null==(e=oe.location.offid)?void 0:e.toLowerCase();te.value=ie.warehouseList.filter((e=>e.offid&&e.offid.toLowerCase().indexOf(null!=a?a:"")>-1))})):void a((()=>{te.value=ie.warehouseList})):void a((()=>{const a=e.toLowerCase();te.value=ie.warehouseList.filter((e=>e.waredesc&&e.waredesc.toLowerCase().indexOf(a)>-1))}));await ie.getWarehouseAll(),a((()=>{te.value=ie.warehouseList}))},ce=async()=>{ae.value.push(l(ee.value))},be=async()=>{le.value.reset(),setTimeout((()=>{ae.value=[],Z.value=l(q)}),200)},me=async()=>{await le.value.validate()&&(0!=ae.value.length?(console.log("ok"),X.notify({type:"positive",message:"Success Save..!",position:"center",progress:!0})):X.notify({type:"negative",message:"Silahkan Add Row dahulu..!",position:"center"}))},ve=t((()=>l(ae.value)));d((()=>ve.value),((e,a)=>{e.map(((e,l)=>{var o,i,s,t,d,r;let n=a[l];if(e.wareid&&e.wareid!=n.wareid){let a=te.value.findIndex((a=>`${a.offid}${a.wareid}`==e.wareid));-1!=a&&(ae.value[l].offid=null!=(o=te.value[a].offid)?o:"")}if(e.blokid&&e.blokid!=n.blokid){let a=de.value.findIndex((a=>`${a.wareid}${a.blokid}`==e.blokid));-1!=a&&(ae.value[l].offid=null!=(i=de.value[a].offid)?i:"",ae.value[l].wareid=null!=(s=de.value[a].wareid)?s:"")}if(e.locid&&e.locid!=n.locid){console.log(e.locid,n.locid);let a=re.value.findIndex((a=>a.locid==e.locid));console.log(a),-1!=a&&(ae.value[l].offid=null!=(t=re.value[a].offid)?t:"",ae.value[l].wareid=null!=(d=re.value[a].wareid)?d:"",ae.value[l].blokid=null!=(r=re.value[a].blokid)?r:"")}}))}),{deep:!0});return ie.getOfficeAll(),ie.getWarehouseAll(),ie.getBlokAll(),ie.getLocationAll(),r((()=>{ie.getOfficeAll().then((()=>{se.value=ie.officeList})),ie.getWarehouseAll().then((()=>{te.value=ie.warehouseList})),ie.getBlokAll().then((()=>{de.value=ie.blokList})),ie.getLocationAll().then((()=>{re.value=ie.locationList}))})),(l,o)=>(n(),u(b(h),{padding:""},{default:f((()=>[c(b(m),{greedy:"",ref_key:"formRef",ref:le},{default:f((()=>[v("div",S,[v("div",F,[c(b(g),{modelValue:b(Z).desc,"onUpdate:modelValue":o[0]||(o[0]=e=>b(Z).desc=e),dense:"",filled:"","lazy-rules":"",rules:H,label:"Description"},null,8,["modelValue"])])]),v("div",W,[v("div",z,[c(b(p),{color:"primary",label:"Add Row","no-caps":"",icon:"add",dense:"",onClick:ce})])]),v("div",N,[v("div",P,[c(b(L),{loading:b(X).loadingBar.isActive,rows:ae.value,columns:Y.value,"rows-per-page-options":[0],ref:"tblRef","table-style":"table-layout: fixed"},{"body-cell-barid":f((({row:a,rowIndex:l})=>[c(b(e),null,{default:f((()=>[c(b(Q),{filled:"",modelValue:a.barid,"onUpdate:modelValue":[e=>a.barid=e,e=>(async(e,a,l)=>{console.log(l);let o=ne.value.findIndex((e=>e.barid==l.toString()));if(-1==o)return;let i=ne.value[o];e.imgbarang=i.imgbarang,e.pdfbarang=i.pdfbarang})(a,0,e)],"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Barang",options:ne.value,rules:H,"option-value":"barid","option-label":"desc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":f((()=>[c(b(V),null,{default:f((()=>[c(b(A),{class:"text-grey"},{default:f((()=>[w(" No results ")])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","options"])])),_:2},1024)])),"body-cell-file":f((({row:a})=>[c(b(e),{"auto-width":"",style:{"white-space":"nowrap"}},{default:f((()=>[v("div",$,[v("div",D,[a.imgbarang||a.pdfbarang?(n(),u(U,{isimage:"",row:a,b64:a.imgbarang.base64,key:a.barid},null,8,["row","b64"])):y("",!0)]),v("div",G,[a.imgbarang||a.pdfbarang?(n(),u(U,{isfile:"",row:a,b64:a.pdfbarang.base64,key:a.barid},null,8,["row","b64"])):y("",!0)]),v("div",T,[a.imgbarang||a.pdfbarang?(n(),u(U,{isbarcode:"",row:a,key:a.barid},null,8,["row"])):y("",!0)])])])),_:2},1024)])),"body-cell-wareid":f((({row:a})=>[c(b(e),null,{default:f((()=>[c(b(Q),{filled:"",modelValue:a.wareid,"onUpdate:modelValue":e=>a.wareid=e,"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Warehouse",options:te.value,rules:H,onFilter:fe,"option-value":"wareunqid","option-label":"waredesc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":f((()=>[c(b(V),null,{default:f((()=>[c(b(A),{class:"text-grey"},{default:f((()=>[w(" No results ")])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","options"])])),_:2},1024)])),"body-cell-offid":f((({row:a})=>[c(b(e),null,{default:f((()=>[c(b(Q),{filled:"",modelValue:a.offid,"onUpdate:modelValue":e=>a.offid=e,"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Office",options:se.value,rules:H,onFilter:ue,"option-value":"offcode","option-label":"offdesc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":f((()=>[c(b(V),null,{default:f((()=>[c(b(A),{class:"text-grey"},{default:f((()=>[w(" No results ")])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","options"])])),_:2},1024)])),"body-cell-remove":f((({row:a,rowIndex:l})=>[c(b(e),null,{default:f((()=>[c(b(p),{dense:"",round:"",color:"negative",icon:"clear",onClick:e=>(async(e,a)=>{ae.value.splice(a,1)})(0,l)},{default:f((()=>[c(b(B),null,{default:f((()=>[w("Remove")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),loading:f((()=>[c(a,{showing:"",color:"primary"})])),_:1},8,["loading","rows","columns"])])]),v("div",J,[v("div",K,[c(b(p),{label:"Kembali",to:{name:"dashboard.transaksi.barang-in-gudang"}},null,8,["to"])]),v("div",M,[c(b(p),{color:"warning",label:"Cancel",onClick:be}),c(b(p),{color:"primary",label:"Save",onClick:me})])])])),_:1},512)])),_:1}))}});export{E as default};
