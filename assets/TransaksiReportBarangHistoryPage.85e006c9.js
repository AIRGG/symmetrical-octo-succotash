import{Q as a,a as e}from"./QTd.14f40a51.js";import{C as l,Q as o,_ as t}from"./ComQDialogBig.ace7afb0.js";import{c as i}from"./index.229e2d0a.js";import{d as s,Q as r,a as n}from"./QPopupProxy.ee2fb865.js";import{j as d,ca as c,c1 as f,r as m,aJ as u,aA as b,a1 as g,b2 as p,a4 as v,d as w,J as _,cb as y,b$ as k,b4 as D,c4 as h,aa as I,a2 as j,ap as C,cN as x}from"./index.1921beeb.js";import{Q as B}from"./QPage.a28e4bed.js";import{Q}from"./module-master.be57f47e.js";import{u as V,a as Y}from"./module-transaksi.a96af80c.js";import{u as q}from"./myglobalstate.9e951e82.js";import"./QSelect.00c3c8b7.js";import"./QItemLabel.ed81b066.js";import"./QList.0ff0e2c9.js";const F={class:"row q-gutter-sm"},M={class:"col-3"},N={class:"row items-center justify-end"},T={class:"col-3"},G={class:"row items-center justify-end"},H={class:"col-3"},A={class:"row q-mt-lg"},O={class:"col"},P={class:"row"},U={class:"col"},L={class:"row q-mt-md"},R={class:"col"},J=["src"],S=d({__name:"TransaksiReportBarangHistoryPage",setup(d){const S=c();q().title="Report History";const E=V();f();const W=Date.now(),$=s.formatDate(W,"YYYY/MM/DD"),z=m(i({datefrom:"",dateto:"",kdcif:"",namacif:"",ibaid:"",isfilter:!1,typetrx:{reqin:!1,reqout:!1,trxin:!1,trxout:!1,nonaktif:!1}})),K=m([]),X=m([{name:"action",label:"Action",field:"",required:!0,align:"center"},{name:"barid",label:"BarID",field:"tmpbarid",align:"left",sortable:!1},{name:"tgl",label:"TrxID",field:"trxidnorut",align:"left",sortable:!1},{name:"norut",label:"Norut",field:"norut",align:"left",sortable:!1},{name:"offdesc",label:"Office",field:"offdesc",align:"left",sortable:!1},{name:"waredesc",label:"Warehouse",field:"waredesc",align:"left",sortable:!1},{name:"blokdesc",label:"Blok",field:"blokdesc",align:"left",sortable:!1},{name:"locdesc",label:"Location",field:"locdesc",align:"left",sortable:!1},{name:"notes",label:"Note",field:"notes",align:"left",sortable:!1},{name:"desc",label:"Desc",field:"desc",align:"left",sortable:!1},{name:"descgroup1",label:"Group1",field:"descgroup1",align:"left",sortable:!1},{name:"descgroup2",label:"Group2",field:"descgroup2",align:"left",sortable:!1},{name:"descgroup3",label:"Group3",field:"descgroup3",align:"left",sortable:!1},{name:"ibaid",label:"Iba ID",field:"ibaid",align:"left",sortable:!1},{name:"kdcif",label:"CIF",field:"kdcif",align:"left",sortable:!1},{name:"namacif",label:"CIF Name",field:"namacif",align:"left",sortable:!1}]);m([{name:"barid",label:"BarID",field:"barid",align:"left",sortable:!0},{name:"trxid",label:"Description",field:"trxid",align:"left",sortable:!0},{name:"norut",label:"Description",field:"norut",align:"left",sortable:!0},{name:"ibaid",label:"Iba ID",field:"ibaid",align:"left",sortable:!1},{name:"kdcif",label:"CIF",field:"kdcif",align:"left",sortable:!1},{name:"namacif",label:"CIF Name",field:"namacif",align:"left",sortable:!1}]);m(i(Y)),m([]),m();const Z=m(!1);m({url1:"",url2:""});const aa=()=>{Z.value=!1},ea=m(!1),la=m(""),oa=async(a,e,l="img")=>{console.log(a,e);let o={barid:a.tmpbarid,file:l};try{const a=await E.getFileByBarId(o);console.log(a);const e=await x(a.data.data.base64);la.value=e.url,ea.value=!0}catch(t){console.log(t)}},ta=async()=>{ea.value=!1};return(s,d)=>{const c=u("print");return b(),g(_(B),{padding:""},{default:p((()=>[v("div",F,[v("div",M,[w(_(y),{filled:"",modelValue:z.value.datefrom,"onUpdate:modelValue":d[1]||(d[1]=a=>z.value.datefrom=a),dense:"",label:"Date From",clearable:""},{append:p((()=>[w(_(k),{name:"event",class:"cursor-pointer"},{default:p((()=>[w(_(r),{cover:"","transition-show":"scale","transition-hide":"scale"},{default:p((()=>[w(_(n),{modelValue:z.value.datefrom,"onUpdate:modelValue":d[0]||(d[0]=a=>z.value.datefrom=a),mask:"YYYY-MM-DD",options:a=>a<=_($)},{default:p((()=>[v("div",N,[D(w(_(h),{label:"Close",color:"primary",flat:""},null,512),[[l]])])])),_:1},8,["modelValue","options"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),v("div",T,[w(_(y),{filled:"",modelValue:z.value.dateto,"onUpdate:modelValue":d[3]||(d[3]=a=>z.value.dateto=a),dense:"",label:"Date To",clearable:""},{append:p((()=>[w(_(k),{name:"event",class:"cursor-pointer"},{default:p((()=>[w(_(r),{cover:"","transition-show":"scale","transition-hide":"scale"},{default:p((()=>[w(_(n),{modelValue:z.value.dateto,"onUpdate:modelValue":d[2]||(d[2]=a=>z.value.dateto=a),mask:"YYYY-MM-DD",options:a=>a<=_($)},{default:p((()=>[v("div",G,[D(w(_(h),{label:"Close",color:"primary",flat:""},null,512),[[l]])])])),_:1},8,["modelValue","options"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),v("div",H,[w(_(h),{round:"",glossy:"",color:"primary",icon:"search",onClick:d[4]||(d[4]=a=>(async()=>{let a=i(z.value);const e=await E.getReportTransaksiHistory(a);console.log(e),K.value=e.data.data.detail,await C(),E.dbBarangInOutGudangDetail=i(e.data.data.detail),console.log(E.dbBarangInOutGudangDetail.length),console.log(E.dbBarangDetailExpand.length)})())},{default:p((()=>[w(_(o),null,{default:p((()=>[I("Search")])),_:1})])),_:1})])]),v("div",A,[v("div",O,[w(_(Q),{columns:X.value,rows:_(K),loading:_(S).loadingBar.isActive,"rows-per-page-options":[0],dense:""},{"body-cell-action":p((({row:e,rowIndex:l})=>[w(a,null,{default:p((()=>[""!=e.tmpbarid&&e.tmpbarid.length>8&&""!=e.imgbarang?(b(),g(_(h),{key:0,dense:"",round:"",color:"primary",icon:"image",onClick:a=>oa(e,l,"img")},null,8,["onClick"])):j("",!0),""!=e.tmpbarid&&e.tmpbarid.length>8&&""!=e.pdfbarang?(b(),g(_(h),{key:1,dense:"",round:"",color:"primary",icon:"picture_as_pdf",onClick:a=>oa(e,l,"pdf")},null,8,["onClick"])):j("",!0)])),_:2},1024)])),loading:p((()=>[w(e,{showing:"",color:"primary"})])),_:1},8,["columns","rows","loading"])])]),w(t,{onHide:aa,"show-dialog":Z.value},{default:p((()=>[v("div",P,[v("div",U,[D(w(_(h),{icon:"print"},null,512),[[c,"#tbl__print"]])])]),v("div",L,[v("div",R,[w(_(Q),{columns:X.value,rows:_(K),loading:_(S).loadingBar.isActive,"rows-per-page-options":[0],dense:"",id:"tbl__print",flat:""},{loading:p((()=>[w(e,{showing:"",color:"primary"})])),_:1},8,["columns","rows","loading"])])])])),_:1},8,["show-dialog"]),w(t,{onHide:ta,"show-dialog":ea.value},{default:p((()=>[w(_(h),{icon:"open_in_new",color:"primary",onClick:d[5]||(d[5]=a=>{return e=la.value,void window.open(e,"_blank");var e})},{default:p((()=>[w(_(o),null,{default:p((()=>[I("Open in New Tab")])),_:1})])),_:1}),v("iframe",{width:"100%",height:"100%",frameborder:"0",src:la.value,id:"frame"},null,8,J)])),_:1},8,["show-dialog"])])),_:1})}}});export{S as default};
