import{j as a,ca as e,x as l,r as s,o,aA as r,a1 as t,b2 as i,a4 as d,d as n,c4 as c,J as u,a3 as p,F as b,aG as g,aa as m,P as f,a2 as k,b4 as v,bo as w,cJ as y,cb as h,cW as j,cN as x,ap as C}from"./index.1921beeb.js";import{Q as _,a as I}from"./module-master.be57f47e.js";import{Q}from"./QTr.f317700d.js";import{Q as V,a as D}from"./QTd.14f40a51.js";import{Q as B}from"./QPage.a28e4bed.js";import{u as G,f as P,t as R}from"./module-transaksi.a96af80c.js";import{u as S}from"./myglobalstate.9e951e82.js";import{c as T}from"./index.229e2d0a.js";import{_ as U}from"./ComImagePdf.5f9f2127.js";import{t as F}from"./upload-file.01a69925.js";import{_ as q}from"./ComQDialogBig.ace7afb0.js";import{_ as z}from"./ComQFile.b7eee83f.js";import"./QList.0ff0e2c9.js";import"./QSelect.00c3c8b7.js";import"./QItemLabel.ed81b066.js";import"./QImg.65c43243.js";import"./QBadge.2b2d9dcd.js";const A={class:"row justify-content-between"},E=d("div",{class:"col"},null,-1),H={class:"col text-right"},L={class:"row q-mt-md"},J={class:"col-12"},M={key:0},N={key:2},O={class:"row"},Y={class:"col-12"},K={class:"row"},W={class:"col-12"},X={class:"row"},Z={class:"col-12"},$={class:"row"},aa={class:"col-12"},ea={class:"row"},la={class:"col-12"},sa={class:"row"},oa={class:"col-12"},ra=a({__name:"TransaksiBarangCreatePage",setup(a){const ra=e();S().title="List Barang (CREATE)";const ta=G(),ia=[a=>a&&a.length>0||"Required!"],da=[a=>a&&a.size>0||"Required!"],na=l({...T(P)}),ca=s(),ua=s([{name:"action",label:"Action",field:"",required:!0,align:"center"},{name:"uploadfile",label:"Uploaded File",field:"uploadfile",required:!1,align:"center",sortable:!1},{name:"barid",label:"BarID",field:"barid",align:"left",sortable:!0},{name:"trxid",label:"TrxID",field:"crtrxid",align:"left",sortable:!0},{name:"desc",label:"Desc",field:"desc",align:"left",sortable:!0},{name:"descgroup1",label:"Group1",field:"descgroup1",align:"left",sortable:!0},{name:"descgroup2",label:"Group2",field:"descgroup2",align:"left",sortable:!0},{name:"descgroup3",label:"Group3",field:"descgroup3",align:"left",sortable:!0},{name:"ibaid",label:"Iba ID",field:"ibaid",align:"left",sortable:!0},{name:"kdcif",label:"CIF",field:"kdcif",align:"left",sortable:!0},{name:"namacif",label:"CIF Name",field:"namacif",align:"left",sortable:!0}]),pa=async()=>{const a=await ta.getTransaksiCreate(),e=[];a.data.data.masterstok.map((async(a,l)=>{let s=T(a);e.push(j.get("/assets?url="+s.imgbarang).then((async e=>{let l={...F};console.log(e);const s=await x(e.data.data.base64);l.bloburl=s.url,l.blob=s.blob,l.base64=e.data.data.base64,a.imgbarang=l}))),e.push(j.get("/assets?url="+s.pdfbarang).then((async e=>{let l={...F};const s=await x(e.data.data.base64);l.bloburl=s.url,l.blob=s.blob,l.base64=e.data.data.base64,a.pdfbarang=l})))})),await Promise.allSettled(e),na.detail=T(a.data.data.masterstok),na.header=T(a.data.data.header[0]),ta.dbBarangDetail=na.detail,ta.dbBarangHeader=na.header};o((()=>{pa()}));const ba=s(!1),ga=async()=>{ba.value=!1,ma.barangstok=T(R)},ma=l({barangstok:T(R),isedit:!1,oldid:null,index:-1}),fa=s(),ka=async()=>{await fa.value.validate()&&(console.log(ma.barangstok),ra.dialog({title:"Confirm",message:"Yakin?, Pastikan semua sudah benar...",cancel:!0,persistent:!0}).onOk((async()=>{let a={header:T(ma.barangstok),detail:[]};if(ma.isedit){try{await ta.editTransaksiCreate(a)}catch(e){return void console.log(e)}ra.notify({type:"positive",message:"Success Save..!",position:"center",progress:!0}),pa()}await C(),ga(),ma.barangstok=T(R),pa()})).onCancel((()=>{})).onDismiss((()=>{})))};return(a,e)=>(r(),t(B,{padding:""},{default:i((()=>[d("div",A,[E,d("div",H,[n(c,{color:"primary",icon:"refresh","no-caps":"",onClick:pa})])]),d("div",L,[d("div",J,[n(u(_),{dense:"",loading:u(ra).loadingBar.isActive,columns:ua.value,rows:u(ta).dbBarangDetail,ref_key:"tblRef",ref:ca,"row-key":"barid"},{header:i((a=>[n(Q,{props:a},{default:i((()=>[(r(!0),p(b,null,g(a.cols,(e=>(r(),t(I,{key:e.name,props:a},{default:i((()=>[m(f(e.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:i((a=>[n(Q,{props:a},{default:i((()=>[(r(!0),p(b,null,g(a.cols,(e=>(r(),t(V,{key:e.name,props:a},{default:i((()=>["action"==e.name?(r(),p("div",M,[n(c,{dense:"",round:"",color:"warning",icon:"edit",onClick:e=>(async(a,e)=>{console.log(a),ma.barangstok=T(a),ma.index=e,ma.isedit=!0,ba.value=!0})(a.row,a.rowIndex)},null,8,["onClick"]),n(c,{dense:"",round:"",color:"negative",icon:"delete",onClick:e=>(async(a,e)=>{ra.dialog({title:"Confirm",message:"Yakin Delete?",cancel:!0,persistent:!0}).onOk((async()=>{let e={header:T(a),detail:[]};try{await ta.deleteTransaksiCreate(e)}catch(l){return void console.log(l)}ra.notify({type:"positive",message:"Success Delete..!",position:"center",progress:!0}),pa()})).onCancel((()=>{})).onDismiss((()=>{}))})(a.row,a.rowIndex)},null,8,["onClick"])])):k("",!0),"uploadfile"==e.name?(r(),t(U,{key:1,row:a.row,rowIndex:a.rowIndex,isshow:""},null,8,["row","rowIndex"])):(r(),p("div",N,f(e.value),1))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),v(n(Q,{props:a},{default:i((()=>[n(V,{colspan:"100%"})])),_:2},1032,["props"]),[[w,a.expand]])])),loading:i((()=>[n(D,{showing:"",color:"primary"})])),_:1},8,["loading","columns","rows"])])]),n(q,{"custom-fn-save":ka,"label-save":ma.isedit?"Update Row":"Add Row","full-width":!1,"full-height":!1,onHide:ga,"show-dialog":ba.value,"custom-style":"width: 600px"},{title:i((()=>[m(" Form Edit ")])),default:i((()=>[n(u(y),{greedy:"",ref_key:"formPopupRef",ref:fa},{default:i((()=>{var a,l,s,o;return[d("div",O,[d("div",Y,[n(h,{modelValue:ma.barangstok.desc,"onUpdate:modelValue":e[0]||(e[0]=a=>ma.barangstok.desc=a),filled:"","lazy-rules":"",rules:ia,label:"Desc",dense:"",placeholder:"Deskripsi Barang.."},null,8,["modelValue"])])]),d("div",K,[d("div",W,[n(h,{modelValue:ma.barangstok.descgroup1,"onUpdate:modelValue":e[1]||(e[1]=a=>ma.barangstok.descgroup1=a),filled:"","lazy-rules":"",rules:[a=>a.length>-1||"a"],label:"Group 1",dense:"",placeholder:"ex: Surat, Kendaraan"},null,8,["modelValue","rules"])])]),d("div",X,[d("div",Z,[n(h,{modelValue:ma.barangstok.descgroup2,"onUpdate:modelValue":e[2]||(e[2]=a=>ma.barangstok.descgroup2=a),filled:"","lazy-rules":"",rules:[a=>a.length>-1||"a"],label:"Group 2",dense:"",placeholder:"ex: Sertifikat, Motor"},null,8,["modelValue","rules"])])]),d("div",$,[d("div",aa,[n(h,{modelValue:ma.barangstok.descgroup3,"onUpdate:modelValue":e[3]||(e[3]=a=>ma.barangstok.descgroup3=a),filled:"","lazy-rules":"",rules:[a=>a.length>-1||"a"],label:"Group 3",dense:"",placeholder:"ex: Sertifikat Rumah, Motor Honda"},null,8,["modelValue","rules"])])]),d("div",ea,[d("div",la,[n(z,{b64:null!=(l=null==(a=ma.barangstok.imgbarang)?void 0:a.base64)?l:void 0,"onUpdate:modelValue":e[4]||(e[4]=a=>ma.barangstok.imgbarang=a),rules:da,label:"Pilih Gambar",accept:"image/png, image/jpeg, image/jpg","is-image":""},null,8,["b64"])])]),d("div",sa,[d("div",oa,[n(z,{b64:null!=(o=null==(s=ma.barangstok.pdfbarang)?void 0:s.base64)?o:void 0,"onUpdate:modelValue":e[5]||(e[5]=a=>ma.barangstok.pdfbarang=a),accept:"application/pdf"},null,8,["b64"])])])]})),_:1},512)])),_:1},8,["label-save","show-dialog"])])),_:1}))}});export{ra as default};
