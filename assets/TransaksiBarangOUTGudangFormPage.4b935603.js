import{Q as a,a as e}from"./QTd.14f40a51.js";import{c as l}from"./index.229e2d0a.js";import{j as o,r as i,ca as s,c as r,w as n,ar as d,aA as t,a1 as u,b2 as c,d as f,J as b,cJ as m,a4 as g,cb as v,c4 as p,aa as w,a3 as y,F as k,a2 as h}from"./index.1921beeb.js";import{Q as j}from"./QPage.a28e4bed.js";import{u as x,Q as _,d as L,t as A,b as B,c as Q}from"./module-master.be57f47e.js";import{Q as C,b as I}from"./QItemLabel.ed81b066.js";import{a as q}from"./QSelect.00c3c8b7.js";import{Q as R}from"./ComQDialogBig.ace7afb0.js";import{u as V,t as S,f as F}from"./module-transaksi.a96af80c.js";import{u as O}from"./myglobalstate.9e951e82.js";import{_ as P}from"./ComPopupImgPdfBarcode.65e8a2e9.js";import"./QList.0ff0e2c9.js";import"./QImg.65c43243.js";import"./ComBarcodeGenerator.1bbbf28b.js";const T={class:"row q-mb-md q-col-gutter-xs"},U={class:"col-12"},$={class:"row q-mb-sm"},D={class:"col-12 text-right"},G={class:"row"},W={class:"col-12"},z=g("br",null,null,-1),J=g("br",null,null,-1),K=g("br",null,null,-1),N=g("br",null,null,-1),E={class:"row justify-evenly",style:{width:"200px"}},H={class:"col"},M={class:"col"},X={class:"col"},Y={class:"row q-mt-md justify-between"},Z={class:"q-gutter-xs"},aa={class:"q-gutter-xs"},ea=o({__name:"TransaksiBarangOUTGudangFormPage",setup(o){O().title="Form Request Barang Keluar Gudang";const ea=V(),la=[a=>a&&a.length>0||"Required!"];i("");const oa=s(),ia=i([{name:"remove",label:"",field:"",align:"left",sortable:!1},{name:"barid",label:"Barang",field:"",align:"left",sortable:!0},{name:"file",label:"File",field:"",align:"left",sortable:!0}]),sa=i(l(S)),ra=i(l(sa.value)),na=i([]),da=i();l(F),l(S),l(L),l(A),l(B),l(Q);const ta=x(),ua=i(l(ta.officeList)),ca=i(l(ta.warehouseList)),fa=i(l(ta.blokList)),ba=i(l(ta.locationList)),ma=i(l(ea.dbBarangDetail).flat(1)),ga=async()=>{na.value.push(l(ra.value))},va=async()=>{da.value.reset(),setTimeout((()=>{na.value=[],sa.value=l(S)}),200)},pa=async()=>{await da.value.validate()&&(0!=na.value.length?(console.log("ok"),oa.notify({type:"positive",message:"Success Save..!",position:"center",progress:!0})):oa.notify({type:"negative",message:"Silahkan Add Row dahulu..!",position:"center"}))},wa=r((()=>l(na.value)));n((()=>wa.value),((a,e)=>{a.map(((a,l)=>{var o,i,s,r,n,d;let t=e[l];if(a.wareid&&a.wareid!=t.wareid){let e=ca.value.findIndex((e=>`${e.offid}${e.wareid}`==a.wareid));-1!=e&&(na.value[l].offid=null!=(o=ca.value[e].offid)?o:"")}if(a.blokid&&a.blokid!=t.blokid){let e=fa.value.findIndex((e=>`${e.wareid}${e.blokid}`==a.blokid));-1!=e&&(na.value[l].offid=null!=(i=fa.value[e].offid)?i:"",na.value[l].wareid=null!=(s=fa.value[e].wareid)?s:"")}if(a.locid&&a.locid!=t.locid){console.log(a.locid,t.locid);let e=ba.value.findIndex((e=>e.locid==a.locid));console.log(e),-1!=e&&(na.value[l].offid=null!=(r=ba.value[e].offid)?r:"",na.value[l].wareid=null!=(n=ba.value[e].wareid)?n:"",na.value[l].blokid=null!=(d=ba.value[e].blokid)?d:"")}}))}),{deep:!0});return ta.getOfficeAll(),ta.getWarehouseAll(),ta.getBlokAll(),ta.getLocationAll(),d((()=>{ta.getOfficeAll().then((()=>{ua.value=ta.officeList})),ta.getWarehouseAll().then((()=>{ca.value=ta.warehouseList})),ta.getBlokAll().then((()=>{fa.value=ta.blokList})),ta.getLocationAll().then((()=>{ba.value=ta.locationList}))})),(l,o)=>(t(),u(b(j),{padding:""},{default:c((()=>[f(b(m),{greedy:"",ref_key:"formRef",ref:da},{default:c((()=>[g("div",T,[g("div",U,[f(b(v),{modelValue:b(sa).desc,"onUpdate:modelValue":o[0]||(o[0]=a=>b(sa).desc=a),dense:"",filled:"","lazy-rules":"",rules:la,label:"Description"},null,8,["modelValue"])])]),g("div",$,[g("div",D,[f(b(p),{color:"primary",label:"Add Row","no-caps":"",icon:"add",dense:"",onClick:ga})])]),g("div",G,[g("div",W,[f(b(_),{loading:b(oa).loadingBar.isActive,rows:na.value,columns:ia.value,"rows-per-page-options":[0],ref:"tblRef","table-style":"table-layout: fixed"},{"body-cell-barid":c((({row:e,rowIndex:l})=>[f(b(a),null,{default:c((()=>[f(b(q),{filled:"",modelValue:e.barid,"onUpdate:modelValue":[a=>e.barid=a,a=>(async(a,e,l)=>{console.log(l);let o=ma.value.findIndex((a=>a.barid==l.toString()));if(-1==o)return;let i=ma.value[o];a.imgbarang=i.imgbarang,a.pdfbarang=i.pdfbarang})(e,0,a)],"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Barang",options:ma.value,rules:la,"option-value":"barid","option-label":"desc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":c((()=>[f(b(C),null,{default:c((()=>[f(b(I),{class:"text-grey"},{default:c((()=>[w(" No results ")])),_:1})])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","options"]),e.imgbarang||e.pdfbarang?(t(),y(k,{key:0},[w(" Office: "),z,w(" Warehouse: "),J,w(" Blok: "),K,w(" Location: "),N],64)):h("",!0)])),_:2},1024)])),"body-cell-file":c((({row:e})=>[f(b(a),{"auto-width":"",style:{"white-space":"nowrap"}},{default:c((()=>[g("div",E,[g("div",H,[e.imgbarang||e.pdfbarang?(t(),u(P,{isimage:"",row:e,b64:e.imgbarang.base64,key:e.barid},null,8,["row","b64"])):h("",!0)]),g("div",M,[e.imgbarang||e.pdfbarang?(t(),u(P,{isfile:"",row:e,b64:e.pdfbarang.base64,key:e.barid},null,8,["row","b64"])):h("",!0)]),g("div",X,[e.imgbarang||e.pdfbarang?(t(),u(P,{isbarcode:"",row:e,key:e.barid},null,8,["row"])):h("",!0)])])])),_:2},1024)])),"body-cell-remove":c((({row:e,rowIndex:l})=>[f(b(a),null,{default:c((()=>[f(b(p),{dense:"",round:"",color:"negative",icon:"clear",onClick:a=>(async(a,e)=>{na.value.splice(e,1)})(0,l)},{default:c((()=>[f(b(R),null,{default:c((()=>[w("Remove")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),loading:c((()=>[f(e,{showing:"",color:"primary"})])),_:1},8,["loading","rows","columns"])])]),g("div",Y,[g("div",Z,[f(b(p),{label:"Kembali",to:{name:"dashboard.transaksi.barang-in-gudang"}},null,8,["to"])]),g("div",aa,[f(b(p),{color:"warning",label:"Cancel",onClick:va}),f(b(p),{color:"primary",label:"Save",onClick:pa})])])])),_:1},512)])),_:1}))}});export{ea as default};
