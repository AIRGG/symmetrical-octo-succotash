import{j as a,ca as e,c1 as l,x as o,r as i,o as s,c as t,w as n,ap as d,aA as r,a1 as c,b2 as u,a4 as f,d as b,J as p,c4 as m,a3 as g,F as v,aG as w,aa as k,P as L,a2 as h,b4 as y,bo as _,cJ as x,cW as j,cN as C,aD as I,aB as B}from"./index.1921beeb.js";import{Q,a as V}from"./QTd.14f40a51.js";import{Q as A,b as F}from"./QItemLabel.ed81b066.js";import{Q as O}from"./QPage.a28e4bed.js";import{a as q}from"./QSelect.00c3c8b7.js";import{u as D,Q as G,a as P,d as U}from"./module-master.be57f47e.js";import{Q as N}from"./QTr.f317700d.js";import{u as R,f as z,t as M}from"./module-transaksi.a96af80c.js";import{u as W}from"./myglobalstate.9e951e82.js";import{c as S}from"./index.229e2d0a.js";import{_ as T}from"./ComImagePdf.5f9f2127.js";import{t as J}from"./upload-file.01a69925.js";import{_ as H}from"./ComQDialogBig.ace7afb0.js";import{_ as K}from"./ComQFile.b7eee83f.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import"./QList.0ff0e2c9.js";import"./QImg.65c43243.js";import"./QBadge.2b2d9dcd.js";const X={class:"row justify-content-between"},Y=(a=>(I("data-v-a7ef5376"),a=a(),B(),a))((()=>f("div",{class:"col"},null,-1))),Z={class:"col text-right"},$={class:"row q-mt-md"},aa={class:"col-12"},ea={key:0},la={key:2},oa={class:"row"},ia={class:"col-12"},sa={class:"row"},ta={class:"col-12"},na={class:"row"},da={class:"col-12"},ra={class:"row"},ca={class:"col-12"},ua={class:"row"},fa={class:"col-12"},ba={class:"row"},pa={class:"col-12"};var ma=E(a({__name:"GudangBarangMoveFormPage",setup(a){const I=e();W().title="List Agunan & Move";const B=R(),E=l(),ma=[a=>a&&a.length>0||"Required!"],ga=[a=>a&&a.size>0||"Required!"],va=o({...S(z)}),wa=i(),ka=i([{name:"action",label:"Action",field:"",required:!0,align:"center"},{name:"uploadfile",label:"Uploaded File",field:"uploadfile",required:!1,align:"center",sortable:!1},{name:"barid",label:"BarID",field:"barid",align:"left",sortable:!0},{name:"trxid",label:"TrxID",field:"crtrxid",align:"left",sortable:!0},{name:"desc",label:"Desc",field:"desc",align:"left",sortable:!0},{name:"descgroup1",label:"Group1",field:"descgroup1",align:"left",sortable:!0},{name:"descgroup2",label:"Group2",field:"descgroup2",align:"left",sortable:!0},{name:"descgroup3",label:"Group3",field:"descgroup3",align:"left",sortable:!0},{name:"offdesc",label:"Office",field:"offdesc",align:"left",sortable:!0},{name:"waredesc",label:"Warehouse",field:"waredesc",align:"left",sortable:!0},{name:"blokdesc",label:"Blok",field:"blokdesc",align:"left",sortable:!0},{name:"locdesc",label:"Location",field:"locdesc",align:"left",sortable:!0},{name:"ibaid",label:"Iba ID",field:"ibaid",align:"left",sortable:!0},{name:"kdcif",label:"CIF",field:"kdcif",align:"left",sortable:!0},{name:"namacif",label:"CIF Name",field:"namacif",align:"left",sortable:!0}]),La=async()=>{await Promise.all([Ca.getOfficeAll(),Ca.getWarehouseAll(),Ca.getBlokAll(),Ca.getLocationAll()]);const a=await B.getBarangGudangMove(),e=[];a.data.data.masterstok.map((async(a,l)=>{let o=S(a);e.push(j.get("/assets?url="+o.imgbarang).then((async e=>{let l={...J};console.log(e);const o=await C(e.data.data.base64);l.bloburl=o.url,l.blob=o.blob,l.base64=e.data.data.base64,a.imgbarang=l}))),e.push(j.get("/assets?url="+o.pdfbarang).then((async e=>{let l={...J};const o=await C(e.data.data.base64);l.bloburl=o.url,l.blob=o.blob,l.base64=e.data.data.base64,a.pdfbarang=l})))})),await Promise.allSettled(e),va.detail=S(a.data.data.masterstok),B.dbBarangDetail=va.detail};s((()=>{La()}));const ha=i(!1),ya=async()=>{ha.value=!1,_a.barangstok=S(M)},_a=o({...S(va),barangstok:S(M),listbarangstok:[],isedit:!1,oldid:null,index:-1}),xa=i(),ja=async()=>{var a,e;if(!(await xa.value.validate()))return;console.log(_a.barangstok),_a.barangstok.blokid=null!=(a=_a.location.blokid)?a:"",_a.barangstok.locid=null!=(e=_a.location.locid)?e:"";let l={header:S(_a.barangstok),detail:[]};if(_a.isedit){try{await B.saveBarangGudangMove(l)}catch(o){return void console.log(o)}I.notify({type:"positive",message:"Success Save..!",position:"center",progress:!0}),La()}await d(),ya(),_a.barangstok=S(M)},Ca=D(),Ia=i(S(Ca.officeList)),Ba=i(S(Ca.warehouseList)),Qa=i(S(Ca.blokList)),Va=i(S(Ca.locationList)),Aa=async(a,e)=>{if(Ia.value&&Ia.value.length>0)return""===a?void e((()=>{Ia.value=Ca.officeList})):void e((()=>{const e=a.toLowerCase();Ia.value=Ca.officeList.filter((a=>a.offdesc&&a.offdesc.toLowerCase().indexOf(e)>-1))}));await Ca.getOfficeAll(),e((()=>{Ia.value=Ca.officeList}))},Fa=async(a,e)=>{if(Ba.value&&Ba.value.length>0)return""===a?_a.location.offid&&_a.location.offid.length>0?void e((()=>{var a;const e=null==(a=_a.location.offid)?void 0:a.toLowerCase();Ba.value=Ca.warehouseList.filter((a=>a.offid&&a.offid.toLowerCase().indexOf(null!=e?e:"")>-1))})):void e((()=>{Ba.value=Ca.warehouseList})):void e((()=>{const e=a.toLowerCase();Ba.value=Ca.warehouseList.filter((a=>a.waredesc&&a.waredesc.toLowerCase().indexOf(e)>-1))}));await Ca.getWarehouseAll(),e((()=>{Ba.value=Ca.warehouseList}))},Oa=async(a,e)=>{if(Qa.value&&Qa.value.length>0)return""===a?va.location.wareid&&va.location.wareid.length>0?void e((()=>{var a;const e=null==(a=va.location.wareid)?void 0:a.toLowerCase();Qa.value=Ca.blokList.filter((a=>a.wareid&&a.wareid.toLowerCase().indexOf(null!=e?e:"")>-1))})):void e((()=>{Qa.value=Ca.blokList})):void e((()=>{const e=a.toLowerCase();Qa.value=Ca.blokList.filter((a=>a.blokdesc&&a.blokdesc.toLowerCase().indexOf(e)>-1))}));await Ca.getBlokAll(),e((()=>{console.log(Ca.blokList,"sini bloklist"),Qa.value=Ca.blokList}))},qa=async(a,e)=>{if(Va.value&&Va.value.length>0)return""===a?va.location.locid&&va.location.locid.length>0?void e((()=>{var a;const e=null==(a=va.location.locid)?void 0:a.toLowerCase();Va.value=Ca.locationList.filter((a=>a.locid&&a.locid.toLowerCase().indexOf(null!=e?e:"")>-1))})):void e((()=>{Va.value=Ca.locationList})):void e((()=>{const e=a.toLowerCase();Va.value=Ca.locationList.filter((a=>a.locdesc&&a.locdesc.toLowerCase().indexOf(e)>-1))}));await Ca.getLocationAll(),e((()=>{console.log(Ca.locationList,"sini locationList"),Va.value=Ca.locationList}))};i([]);const Da=t((()=>S(_a.location))),Ga=i(!1);return n((()=>Da.value),(async(a,e)=>{if(Ga.value)return Ga.value=!1,void(await d());if(a.blokid&&a.blokid!=e.blokid){-1!=Qa.value.findIndex((e=>e.blokunqid==a.blokid))&&(_a.location.locid="",await d())}if(a.locid&&a.locid!=e.locid){console.log(a.locid,e.locid);let l=Va.value.findIndex((e=>e.locunqid==a.locid));console.log(),console.log(Va.value,l),-1!=l&&(console.log(Va.value[l],"ada didalem sini"),_a.location.blokid=Va.value[l].blokid,Ga.value=!0,await d())}})),(a,e)=>(r(),c(p(O),{padding:""},{default:u((()=>[f("div",X,[Y,f("div",Z,[b(p(m),{color:"primary",icon:"refresh",onClick:e[0]||(e[0]=a=>La()),"no-caps":""})])]),f("div",$,[f("div",aa,[b(p(G),{dense:"",loading:p(I).loadingBar.isActive,columns:ka.value,rows:p(B).dbBarangDetail,ref_key:"tblRef",ref:wa,"row-key":"barid",class:"my-sticky-column-table"},{header:u((a=>[b(p(N),{props:a},{default:u((()=>[(r(!0),g(v,null,w(a.cols,(e=>(r(),c(p(P),{key:e.name,props:a},{default:u((()=>[k(L(e.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:u((a=>[b(p(N),{props:a},{default:u((()=>[(r(!0),g(v,null,w(a.cols,(e=>(r(),c(p(Q),{key:e.name,props:a},{default:u((()=>["action"==e.name?(r(),g("div",ea,[b(p(m),{dense:"",round:"",color:"warning",icon:"edit",onClick:e=>(async(a,e)=>{console.log(a),_a.barangstok=S(a),_a.index=e,_a.isedit=!0,ha.value=!0,E.getKey,_a.location=S(U),ha.value=!0,Ia.value=Ca.officeList,_a.location.offid=a.offid,Ba.value=Ca.warehouseList,_a.location.wareid=a.wareid,Qa.value=Ca.blokList,_a.location.blokid=a.blokid,Va.value=Ca.locationList,_a.location.locid=a.locid})(a.row,a.rowIndex)},null,8,["onClick"])])):h("",!0),"uploadfile"==e.name?(r(),c(T,{key:1,row:a.row,rowIndex:a.rowIndex,isshow:""},null,8,["row","rowIndex"])):(r(),g("div",la,L(e.value),1))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),y(b(p(N),{props:a},{default:u((()=>[b(p(Q),{colspan:"100%"})])),_:2},1032,["props"]),[[_,a.expand]])])),loading:u((()=>[b(p(V),{showing:"",color:"primary"})])),_:1},8,["loading","columns","rows"])])]),b(H,{"custom-fn-save":ja,"label-save":_a.isedit?"Update Row":"Add Row","full-width":!1,"full-height":!1,onHide:ya,"show-dialog":ha.value,"custom-style":"width: 600px"},{title:u((()=>[k(" Form Move Barang ")])),default:u((()=>[b(p(x),{greedy:"",ref_key:"formPopupRef",ref:xa},{default:u((()=>{var a,l,o,i;return[f("div",oa,[f("div",ia,[b(p(q),{filled:"",modelValue:_a.location.offid,"onUpdate:modelValue":e[1]||(e[1]=a=>_a.location.offid=a),"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Office",options:Ia.value,rules:ma,onFilter:Aa,"option-value":"offcode","option-label":"offdesc","emit-value":"","map-options":"",behavior:"menu",disable:""},{"no-option":u((()=>[b(p(A),null,{default:u((()=>[b(p(F),{class:"text-grey"},{default:u((()=>[k(" No results ")])),_:1})])),_:1})])),_:1},8,["modelValue","options"])])]),f("div",sa,[f("div",ta,[b(p(q),{filled:"",modelValue:_a.location.wareid,"onUpdate:modelValue":e[2]||(e[2]=a=>_a.location.wareid=a),"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Warehouse",options:Ba.value,rules:ma,onFilter:Fa,"option-value":"wareunqid","option-label":"waredesc","emit-value":"","map-options":"",behavior:"menu",disable:""},{"no-option":u((()=>[b(p(A),null,{default:u((()=>[b(p(F),{class:"text-grey"},{default:u((()=>[k(" No results ")])),_:1})])),_:1})])),_:1},8,["modelValue","options"])])]),f("div",na,[f("div",da,[b(p(q),{filled:"",modelValue:_a.location.blokid,"onUpdate:modelValue":e[3]||(e[3]=a=>_a.location.blokid=a),"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Blok",options:Qa.value,rules:ma,onFilter:Oa,"option-value":"blokunqid","option-label":"blokdesc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":u((()=>[b(p(A),null,{default:u((()=>[b(p(F),{class:"text-grey"},{default:u((()=>[k(" No results ")])),_:1})])),_:1})])),_:1},8,["modelValue","options"])])]),f("div",ra,[f("div",ca,[b(p(q),{filled:"",modelValue:_a.location.locid,"onUpdate:modelValue":e[4]||(e[4]=a=>_a.location.locid=a),"use-input":"",dense:"","lazy-rules":"","input-debounce":"0",label:"Location",options:Va.value,rules:ma,onFilter:qa,"option-value":"locunqid","option-label":"locdesc","emit-value":"","map-options":"",behavior:"menu"},{"no-option":u((()=>[b(p(A),null,{default:u((()=>[b(p(F),{class:"text-grey"},{default:u((()=>[k(" No results ")])),_:1})])),_:1})])),_:1},8,["modelValue","options"])])]),f("div",ua,[f("div",fa,[b(K,{b64:null!=(l=null==(a=_a.barangstok.imgbarang)?void 0:a.base64)?l:void 0,"onUpdate:modelValue":e[5]||(e[5]=a=>_a.barangstok.imgbarang=a),rules:ga,label:"Pilih Gambar",accept:"image/png, image/jpeg, image/jpg","is-image":"","is-show":""},null,8,["b64"])])]),f("div",ba,[f("div",pa,[b(K,{b64:null!=(i=null==(o=_a.barangstok.pdfbarang)?void 0:o.base64)?i:void 0,"onUpdate:modelValue":e[6]||(e[6]=a=>_a.barangstok.pdfbarang=a),accept:"application/pdf","is-show":""},null,8,["b64"])])])]})),_:1},512)])),_:1},8,["label-save","show-dialog"])])),_:1}))}}),[["__scopeId","data-v-a7ef5376"]]);export{ma as default};
