import{c as e,br as i,r as l,w as t,as as n,h as r,b7 as a,bs as o,cV as u}from"./index.1921beeb.js";var s=i({name:"QImg",props:{...{ratio:[String,Number]},src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:16/9},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(i,{slots:s,emit:g}){const c=l(i.initialRatio),d=function(i,l){return e((()=>{const e=Number(i.ratio||(void 0!==l?l.value:void 0));return!0!==isNaN(e)&&e>0?{paddingBottom:100/e+"%"}:null}))}(i,c);let v;const m=[l(null),l(void 0!==i.placeholderSrc?{src:i.placeholderSrc}:null)],p=l(0),f=l(!1),h=l(!1),S=e((()=>`q-img q-img--${!0===i.noNativeMenu?"no-":""}menu`)),y=e((()=>({width:i.width,height:i.height}))),b=e((()=>`q-img__image ${void 0!==i.imgClass?i.imgClass+" ":""}q-img__image--with${!0===i.noTransition?"out":""}-transition`)),_=e((()=>({...i.imgStyle,objectFit:i.fit,objectPosition:i.position})));function q(){return i.src||i.srcset||i.sizes?{src:i.src,srcset:i.srcset,sizes:i.sizes}:null}function w(e){if(clearTimeout(v),h.value=!1,null===e)return f.value=!1,m[0].value=null,void(m[1].value=null);f.value=!0,m[p.value].value=e}function z({target:e}){null!==v&&(clearTimeout(v),c.value=0===e.naturalHeight?.5:e.naturalWidth/e.naturalHeight,N(e,1))}function N(e,i){null!==v&&1e3!==i&&(!0===e.complete?function(e){if(null===v)return;p.value=1===p.value?0:1,m[p.value].value=null,f.value=!1,h.value=!1,g("load",e.currentSrc||e.src)}(e):v=setTimeout((()=>{N(e,i+1)}),50))}function T(e){clearTimeout(v),f.value=!1,h.value=!0,m[0].value=null,m[1].value=null,g("error",e)}function k(e){const l=m[e].value,t={key:"img_"+e,class:b.value,style:_.value,crossorigin:i.crossorigin,decoding:i.decoding,referrerpolicy:i.referrerpolicy,height:i.height,width:i.width,loading:i.loading,fetchpriority:i.fetchpriority,"aria-hidden":"true",draggable:i.draggable,...l};return p.value===e?(t.class+=" q-img__image--waiting",Object.assign(t,{onLoad:z,onError:T})):t.class+=" q-img__image--loaded",n="img"+e,a=r("img",t),r("div",{class:"q-img__container absolute-full",key:n},a);var n,a}function j(){return!0!==f.value?r("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},o(s[!0===h.value?"error":"default"])):r("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},void 0!==s.loading?s.loading():!0===i.noSpinner?void 0:[r(u,{color:i.spinnerColor,size:i.spinnerSize})])}return t((()=>q()),w),w(q()),n((()=>{clearTimeout(v),v=null})),()=>{const e=[];return null!==d.value&&e.push(r("div",{key:"filler",style:d.value})),!0!==h.value&&(null!==m[0].value&&e.push(k(0)),null!==m[1].value&&e.push(k(1))),e.push(r(a,{name:"q-transition--fade"},j)),r("div",{class:S.value,style:y.value,role:"img","aria-label":i.alt},e)}}});export{s as Q};
